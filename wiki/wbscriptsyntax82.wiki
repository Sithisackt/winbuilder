<h1>Script Syntax Changes that appear in version 082</h1>
<wiki:toc max_depth="2" />

This page describes new functionality introduced with !WinBuilder 082.
Older !WinBuilder versions cannot work with this functionality.

<br>
----
=File Handling=
==!FileDelete==
{{{
FileDelete,<FileToDelete> [,Nowarn,Norec]
}}}
*New optional Nowarn, Norec parameter added*

This command will delete files. It uses Win32 API as a silent operation deleting all files that match the search criteria. You can view the result of this operation on the respective log entry. Beware that all deleted files are *immediately removed* instead of being moved to the recycle bin.

FileDelete supports wildcards ( *.* )
 * If wild cards are specified then, unless Norec is specified, any files matching the wild card will also be deleted _*in subdirectories*_ of the specified directory. 
 * If Norec is specified then only matching files in the specified directory will be deleted.
 * By default if the specified file does not exist or if no files match the wild card then a warning will be put into the log file. 
 * If NoWarn is specified then this warning log is suppressed.
 * The optional Nowarn and Norec parameters can be specified in any order.

=== Example: ===
{{{
FileDelete,c:\MyPath\*.txt,NoWarn,Norec
}}}
In this example !FileDelete will delete all text files (`*`.txt) from the !MyPath directory only. If no files are found no warning will be added to the log file.

<br>
----
=Miscellaneous Commands=
* Exit - optional Nowarn parameter added 
* System,Comp80 - sets winbuilder 80 compatibility
* System,HasUAC - sets a variable indicating if Vista / Win7 UAC is enabled
* System,IsTerminal - sets a variable indicating if running under terminal server ( remote desktop ) 
* System,Log - controls logging to log file

==Exit==
{{{
Exit,<exit message>[,Nowarn]
}}}
Since there are conditions, where the exit is intended, and a warning icon would confuse the user, the `NOWARN` parameter was added. If the NOWARN option is specified then an information icon is associated with the message in the log.

===Example: ===
Exit,"Script is disabled for this source",Nowarn

==System,Comp80==
{{{
System,Comp80,{on|off}
}}}
 * Use this command to force compatability with winbuilder version 80. WB 082 is in some situations incompatible with WB 080 because of the way that variables are treated internally.
 * With System,Comp80,ON or System,Comp80,OFF you can make the current WB script processing (mostly) compatible to the processing of WB 080.
 * *When starting WB 082, by default the compatibility is switched off.*
 * If compatability is set to off then scripts are processed 2 to 3 times faster.

===Example: ===
{{{
System,Comp80,off
}}}


==System,HasUAC==
{{{
System,HasUAC,<%var%>
}}}
This command will set the variable to true if Vista / Win 7 UAC ( User Account Control ) is enabled. This can cause problems to some projects.

===Example: ===
{{{
System,HasUAC,%var%
If,%var%,Equal,True,begin
    Message,"Error: UAC is enabled. This may cause problems when building.",INFORMATION,15
    Halt,"Error: UAC is anabled. This may cause problems when building. "
End
}}}


==System,!IsTerminal==
{{{
System,IsTerminal,<%var%>
}}}
This command will set the variable to true if winbuilder is being run under terminal server ( remote desktop ). This can cause problems to some projects.

=== Example: ===
{{{
System,IsTerminal,%var%
If,%var%,Equal,True,begin
    Message,"Error: It seems you are working in a Terminalserver session. This might cause unexpected problems. ",INFORMATION,15
    Echo,"Error: It seems you are working in a Terminalserver session. This might cause unexpected problems."
End
}}}
 
==System,Log==
{{{
System,Log,{on|off}
}}}
When in your project a certain function is used many, many times, it usually expands inside the log.html into many unnecessary lines.
This command stops / restarts logging to log.html

*It is only in effect for the remainder of the current script!*

===Example: ===
{{{
System,Log,off
}}}